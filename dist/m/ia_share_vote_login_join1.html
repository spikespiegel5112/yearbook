<!DOCTYPE html>
<html>

<head lang="ch">
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" id="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
    <title>分享投票-已登录已加入-我要投票</title>
    <link rel="stylesheet" href="../css/m.all.min.css">
    <link rel="stylesheet" href="../assets/css/normalize.css" type="text/css" media="all">
    <link rel="stylesheet" href="../assets/css/bootstrap.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="../assets/css/bootstrap-theme.min.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="../assets/css/mobilebone.animate.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="../assets/css/font-awesome.css" type="text/css" media="all"/>
</head>

<body class='bg_f6f6f6'>
<div class="main_container share_container">
    <div class="ybwechatheader_wrapper">
        <!--<a class="left_btn back_btn" href="javascript:;"></a>-->
        <p>来自忆尔的分享</p>
    </div>
    <div class="share_main">
        <div class="share_head">
            <ul>
                <li>
                    <img class="head" src="../img/m/default/vote_result_avatar_100_100_00000.jpg">
                </li>
                <li>
                    <div class="user_name"><span>张晓亮</span></div>
                    <div class="book_name">《青春纪念册》</div>
                </li>
                <li>
                    <div><a href="javascript:;">点击进入</a></div>
                    <div>
                        <img src="../img/m/ia/light_vote.png" width="25" height="25">
                        <span>投票分享</span>
                    </div>
                </li>
            </ul>
        </div>
        <div class="share_con">
            <h4 class="vote_caption">投票：“谁是我们班最受宠老师”</h4>

            <div class="vote_list_result">
                <table>
                    <tbody>
                    <tr class="cm_bg_f7">
                        <th class='rank'>排名</th>
                        <th class='name'>选项</th>
                        <th class='radio'>比例</th>
                        <th class='votes'>票数</th>
                    </tr>
                    <tr>
                        <td class="color_eb634c"></td>
                        <td>张老师</td>
                        <td>31</td>
                        <td>15</td>
                    </tr>
                    <tr>
                        <td class="color_ff8828"></td>
                        <td>李老师</td>
                        <td>15</td>
                        <td>9</td>
                    </tr>
                    <tr>
                        <td class="color_a0d350"></td>
                        <td>张老师</td>
                        <td>31</td>
                        <td>15</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>李老师</td>
                        <td>15</td>
                        <td>9</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>张老师</td>
                        <td>31</td>
                        <td>15</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>李老师</td>
                        <td>15</td>
                        <td>9</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>张老师</td>
                        <td>31</td>
                        <td>15</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>李老师</td>
                        <td>15</td>
                        <td>9</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <ul class="share_vote1 hidden">
                <li class="caption">
                    <ul>
                        <li class="list">排名</li>
                        <li class="option">选项</li>
                        <li class="ratio">比例</li>
                        <li class="num">票数</li>
                    </ul>
                </li>
                <li>
                    <ul>
                        <li class="list first">1</li>
                        <li class="option">张老师</li>
                        <li class="ratio">
                            <div>
                                <span class="percent ratio1" data-percent="70"></span>
                                <span class="percent ratio2" data-percent="30"></span>
                            </div>
                            <span class="percent_num">70%</span>
                        </li>
                        <li class="num">42</li>
                    </ul>
                </li>
                <li>
                    <ul>
                        <li class="list second">2</li>
                        <li class="option">张老师</li>
                        <li class="ratio">
                            <div>
                                <span class="percent ratio1" data-percent="60"></span>
                                <span class="percent ratio2" data-percent="40"></span>
                            </div>
                            <span class="percent_num">60%</span>
                        </li>
                        <li class="num">42</li>
                    </ul>
                </li>
                <li>
                    <ul>
                        <li class="list third">3</li>
                        <li class="option">张老师</li>
                        <li class="ratio">
                            <div>
                                <span class="percent ratio1" data-percent="50"></span>
                                <span class="percent ratio2" data-percent="50"></span>
                            </div>
                            <span class="percent_num">50%</span>
                        </li>
                        <li class="num">42</li>
                    </ul>
                </li>
                <li>
                    <ul>
                        <li class="list">4</li>
                        <li class="option">张老师</li>
                        <li class="ratio">
                            <div>
                                <span class="percent ratio1" data-percent="40"></span>
                                <span class="percent ratio2" data-percent="60"></span>
                            </div>
                            <span class="percent_num">40%</span>
                        </li>
                        <li class="num">42</li>
                    </ul>
                </li>
            </ul>
            <div class="vote_btn">
                <button type="button">我要投票</button>
            </div>
        </div>
    </div>
    <ul class="share_tool">
        <li>
            <a class="comment" href="javascript:;">
                <span></span>评论
            </a>
        </li>
        <li>
            <a class="praise" href="javascript:;">
                <span></span>点赞
            </a>
        </li>
        <li>
            <a class="share" href="javascript:;">
                <span></span>分享
            </a>
        </li>
    </ul>
    <div class="share_shadow"></div>
</div>
<!--底部导航-->
<div class="footer_nav">
    <ul>
        <li>
            <a href="index.html">
                <span class="home"></span>
                <p>首页</p>
            </a>
        </li>
        <li>
            <a href="ia_msg.html">
                <span class="msg"></span>
                <p>消息</p>
            </a>
        </li>
        <li class="active" id="open_new_option">
            <a href="javascript:;">
                <span class="new"></span>
                <p>新建</p>
            </a>
        </li>
        <li>
            <a href="pc_mybookshelf.html">
                <span class="bookshelf"></span>
                <p>书架</p>
            </a>
        </li>
        <li>
            <a href="pc_main.html">
                <span class="my"></span>
                <p>我的</p>
            </a>
        </li>
    </ul>
</div>
<!--pop new content-->
<div class="open_new_container">
    <div class="new_option">
        <ul>
            <li class="new_ph">
                <a href="booklist_photo.html">
                    <img src="../img/m/icon/new_photo_book.png">
                    <p>新建照片书</p>
                </a>
            </li>
            <li class="new_ia">
                <a href="booklist_ia.html">
                    <img src="../img/m/icon/new_interact_book.png">
                    <p>新建互动册</p>
                </a>
            </li>
            <li class="join_ia">
                <a href="ia_invitation_joinbook.html">
                    <img src="../img/m/icon/join_interact_book.png">
                    <p>加入互动册</p>
                </a>
            </li>
        </ul>
    </div>
    <div class="close_btn"><a href="javascript:;">×</a></div>
</div>
<!--加入输入邀请码-->
<div class="input_invitation_code">
    <div class="input_code">
        <a class="close" href="javascript:;">×</a>
        <label>请输入邀请码</label>
        <input type="text" name="invite_code" placeholder="">
        <button type="button">加入</button>
    </div>
</div>
<script src="../assets/js/jquery.min.js"></script>
<script src="../js/m_main.js"></script>
<script>
    $(function () {
        joinBook();
        setViewHeight();
        setPercent();
    });

    /*
     * 加入 弹出输入邀请码
     * */
    function joinBook() {
        $('.login_group .join').on('touchend', function () {
            $('.input_invitation_code').fadeIn();
        });
        $('.input_code .close').on('touchend', function () {
            $('.input_invitation_code').fadeOut();
        });
    }

    /*
     * 设置页面高度
     * */
    function setViewHeight() {
        var height = window.screen.height;
        $('.share_container').height(height - 67);
    }
    /*
     * 投票百分比
     * */
    function setPercent() {
        $('.percent').each(function () {
            var percent = $(this).attr('data-percent');
            $(this).css('width', percent + '%');
        });
    }

    function normalResult() {
        var trEl = $('.vote_list_result tr');
        trEl.each(function () {
            var rankTdEl = $(this).find('td').eq(0);
            var percentTdEl = $(this).find('td').eq(2);
            var percentage = percentTdEl.text();
            var progressbar = "<span class='progressbar'><label></label></span>";
            $('.vote_list_result tr').each(function () {
                $this = $(this);
                var rankTdEl = $this.find('td').eq(0);
                var trIndex = $(this).index();
                rankTdEl.text(trIndex);
            })
            rankTdEl.text();
            percentTdEl.prepend(progressbar).append('%');
            percentTdEl.find('label').css('width', percentage + '%');

            //获取选项的文本给每个此td添加到一个title属性上。
            var tdEl2 = $(this).find('td').eq(1);
            var nameTitle = tdEl2.text();
            tdEl2.attr('title', nameTitle);
        });


        trEl.click(function () {
            $this = $(this);
            if ($this.hasClass('active')) {
                return;
            } else if ($this.index() != 0) {
                $this.siblings().removeClass('active');
                $this.addClass('active')
            }
        });
        if ($('.vote_head_title .anonymous_vote').length == 1)
            $('.vote_form .btn2').css('background', '#ccc').attr('disabled', 'disabled');

        $('.vote_form .btn2').click(function () {
            if ($(this).attr('disabled')) {
                return;
            } else {
                art.dialog({
                    title: '投票详情',
                    lock: true,
                    content: document.querySelector('.voteresult_dialog_wrapper')
                });
            }
        });
    }

    $(document).ready(function () {
        normalResult();
    })
</script>
</body>

</html>
