<!DOCTYPE html>
<html>

<head lang="en">
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">
	<meta name="keywords" content="">
	<title>忆尔3.5-书册列表</title>
	<link rel="stylesheet" href="http://at.alicdn.com/t/font_1464916563_8422954.css" type="text/css" media="all">
	<!-- build:css css/all.min.css -->
	<link rel="stylesheet" href="css/reset.css" type="text/css" media="all">
	<link rel="stylesheet" href="css/common.css" type="text/css" media="all">
	<link rel="stylesheet" href="css/booklist.css" type="text/css" media="all">
	<!-- endbuild -->
	<link rel="stylesheet" type="text/css" href="assets/css/jquery.fancybox.css" media="screen" />
	<link rel="stylesheet" type="text/css" href="assets/css/font-awesome.css" media="screen" />
	<link rel="stylesheet" type="text/css" href="assets/css/chosen.css" media="screen" />
</head>

<body>
	<!--头部导航-->
	<div class="cm_header_nav">
		<div class="logo">
			<a href="_index.html"><img src="img/logo.png"></a>
		</div>
		<div class="nav">
			<ul>
				<li><a href="_index.html">首页</a></li>
				<li class="photos">
					<a href="booklist_photo.html">照片书<i class="icon-caret-down"></i></a>
					<ul class="style_list">
						<li>
							<a href="javascript:;">
								<i class="icon-github-alt"></i>宝宝
							</a>
						</li>
						<li>
							<a href="javascript:;">
								<i class="icon-plane"></i>旅行
							</a>
						</li>
						<li>
							<a href="javascript:;">
								<i class="ybiconfont ybicon-hearthollow"></i>爱情
							</a>
						</li>
						<li>
							<a href="javascript:;">
								<i class="icon-home"></i>家庭
							</a>
						</li>
						<li>
							<a href="javascript:;">
								<i class="icon-glass"></i>聚会
							</a>
						</li>
					</ul>
				</li>
				<li><a class="active" href="booklist_ia.html">互动册</a></li>
				<li><a href="pc_mybookshelf.html">个人中心</a></li>
				<li><a href="static_instruction_entrance.html">使用指南</a></li>
			</ul>
		</div>
		<div class="nav_login">
			<span class='ybiconfont ybicon-user'></span>
			<ul>
				<li><a href="access_login.html" class="active">登录</a></li>
				<li><a href="access_register.html">注册</a></li>
			</ul>
		</div>
	</div>
	<div class="cm_header_shadow"></div>
	<div class='agb_banner_wrapper '>
		<!--<ul class='agb_bannermenu_wrapper'>
			<li class='active'><a href="javascript:;">全部纪念册</a></li>
			<li><a href="javascript:;">个人照片书</a></li>
			<li><a href="javascript:;">多人互动册</a></li>
		</ul>-->
		<ul class='agb_bannermain_wrapper'>
			<!--<li class=''>
				<p>数百个纪念册模板、千个书页模板任您自由组合，</p>
				<p>不管是毕业册、聚会册还是个人照片书，在这里可以轻而易举的制作出来！</p>
				<img class='agb_banner_img ' width='1920' height='320' src="img/autographbook/agb_banner1_img_00000.jpg">
			</li>-->
			<!-- <li class='active'>
				<p>照片书能记录您的照片信息，让您和家人成为书中的主角、封面上的明星，</p>
				<p>或者写段游记，分门别类、分时编册，像流行杂志一样，支持多种装订方式。</p>
				<img class='agb_banner_img ' width='1920' height='320' src="img/autographbook/agb_banner2_img_00000.jpg">
			</li> -->
			<li class=''>
				<p>多人互动册分为聚会册和毕业册两种，您可以邀请好友、同学一起来和您制作纪念册，</p>
				<p>在这里大家可以互赠寄语、发表感言、上传靓照、发起投票，系统将自动汇聚成册，留下那段美好的青春记忆。</p>
				<img class='agb_banner_img ' width='1920' height='320' src="img/banner/agb_banner3_img_00000.jpg">
			</li>
		</ul>
	</div>
	<div class='mian_container bg_f5f5f5'>
		<div class='left_content_wrapper'>
			<div class='filter_wrapper'>
				<div class='filter_item'>
					<div class='module_title_item'>
						<h5>按分类筛选</h5>
						<div class='dash'></div>
					</div>
					<ul>
						<li><a class="all_style" href="javascript:;">全部</a></li>
						<li><a class="one_style" href="javascript:;">青春</a></li>
						<li><a class="one_style" href="javascript:;">复古</a></li>
						<li><a class="one_style" href="javascript:;">老照片</a></li>
						<li><a class="one_style" href="javascript:;">动漫风</a></li>
						<li><a class="one_style" href="javascript:;">手绘</a></li>
						<li><a class="one_style" href="javascript:;">田园风</a></li>
						<li><a class="one_style" href="javascript:;">金属质感</a></li>
						<li><a class="one_style" href="javascript:;">烫金</a></li>
						<li><a class="one_style" href="javascript:;">运动</a></li>
						<li><a class="one_style" href="javascript:;">非主流</a></li>
						<li><a class="one_style" href="javascript:;">抒情浪漫</a></li>
						<li><a class="one_style" href="javascript:;">庄重大方</a></li>
						<li><a class="one_style" href="javascript:;">深沉凝重</a></li>
						<li><a class="one_style" href="javascript:;">冷掉</a></li>
						<li><a class="one_style" href="javascript:;">冷掉</a></li>
						<li><a class="one_style" href="javascript:;">冷掉</a></li>
						<li><a class="one_style" href="javascript:;">冷掉</a></li>
					</ul>
				</div>
				<div class='filter_item'>
					<div class='module_title_item'>
						<h5>按风格筛选</h5>
						<div class='dash'></div>
					</div>
					<ul>
						<li><a class="all_style" href="javascript:;">全部</a></li>
						<li><a class="one_style" href="javascript:;">青春</a></li>
						<li><a class="one_style" href="javascript:;">复古</a></li>
						<li><a class="one_style" href="javascript:;">老照片</a></li>
						<li><a class="one_style" href="javascript:;">动漫风</a></li>
						<li><a class="one_style" href="javascript:;">手绘</a></li>
						<li><a class="one_style" href="javascript:;">田园风</a></li>
						<li><a class="one_style" href="javascript:;">金属质感</a></li>
						<li><a class="one_style" href="javascript:;">烫金</a></li>
						<li><a class="one_style" href="javascript:;">运动</a></li>
						<li><a class="one_style" href="javascript:;">非主流</a></li>
						<li><a class="one_style" href="javascript:;">抒情浪漫</a></li>
						<li><a class="one_style" href="javascript:;">庄重大方</a></li>
						<li><a class="one_style" href="javascript:;">深沉凝重</a></li>
						<li><a class="one_style" href="javascript:;">冷掉</a></li>
						<li><a class="one_style" href="javascript:;">冷掉</a></li>
						<li><a class="one_style" href="javascript:;">冷掉</a></li>
						<li><a class="one_style" href="javascript:;">冷掉</a></li>
					</ul>
				</div>
			</div>
		</div>
		<div class='right_content_wrapper'>
			<div class='agbcover_wrapper'>
				<div class='module_title_item'>
					<h5>全部照片书</h5>
					<div class='dash'>
						<div class='dash_92c153'></div>
					</div>
				</div>
				<div class="tpl_sort_box">
					<select name="" class="tpl_sort">
						<option>按销量排序</option>
						<option>按好评量排序</option>
						<option>最新上架</option>
						<option>最高人气</option>
					</select>
				</div>
				<ul>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class='agbcover_title hide_title' max-length="10">青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class='beginproduce' href='booklist_detail.html'>我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class='agbcover_title hide_title' max-length="10">青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class='beginproduce' href='booklist_detail.html'>我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class="agbcover_title hide_title" max-length="10">青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class="beginproduce" href="booklist_detail.html">我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class='agbcover_title hide_title' max-length="10">青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class='beginproduce' href='booklist_detail.html'>我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class='agbcover_title hide_title' max-length="10">青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class='beginproduce' href='booklist_detail.html'>我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class="agbcover_title hide_title" max-length="10">青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class="beginproduce" href="booklist_detail.html">我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class='agbcover_title hide_title' max-length="10">青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class='beginproduce' href='booklist_detail.html'>我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class='agbcover_title hide_title' max-length="10">青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class='beginproduce' href='booklist_detail.html'>我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class="agbcover_title hide_title" max-length="10">青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class="beginproduce" href="booklist_detail.html">我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class='agbcover_title hide_title' max-length="10">青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class='beginproduce' href='booklist_detail.html'>我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class='agbcover_title hide_title' max-length="10">青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class='beginproduce' href='booklist_detail.html'>我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
					<li>
						<a class='bookcover' href="booklist_detail.html">
							<span class='agbcover_bg_item'></span>
							<img src="img/default/albumcover_205_295_1_00000.jpg">
						</a>
						<b class="agbcover_title hide_title" max-length="10">青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆青春记忆</b>
						<div class='sold'>已售出:<span>1093</span></div>
						<!--<a class="beginproduce" href="booklist_detail.html">我要制作</a>-->
						<a class='preview_book' href='javascript:;'>模版预览</a>
					</li>
				</ul>
				<div class='all_loadmore'>
					<a href="javascript:;">加载更多<span></span></a>
				</div>
			</div>
		</div>
		<div class='clearfloat'></div>
	</div>
	<!--底部-->
	<div class="footer">
		<div class="footer_info">
			<a class="common_yblogoshort_item ybiconfont ybicon-yblogoshort" href="javascript:;"></a>
			<div class="footer_title">
				<div>忆尔-在线DIY纪念册平台</div>
				<p>专业在线制作电子书册平台</p>
				<p>DIY出独一无二的青春纪念册</p>
			</div>
		</div>
		<div class="footer_list">
			<div class='footer_qrcode_wrapper'>
				<img src="img/footer_wx.png">
			</div>
			<div class='footer_listleft_wrapper'>
				<div class="ft_nav">
					<a href="javascript:;">客服电话 400 0610 127</a>
					<a href="javascript:;">客服QQ</a>
					<a href="javascript:;">客服邮箱</a>
					<a href="javascript:;">关于我们</a>
				</div>
				<p class="ft_copyright">苏ICP备11087253号-2 \ © 2014 无锡众志和达数据计算股份有限公司</p>
				<div class="ft_shares">
					<a href="javascript:;" class="x83"><img src="img/hy_83x30.png"></a>
					<a class='ybiconfont ybicon-weibotencent' href="javascript:;"></a>
					<a class='ybiconfont ybicon-weibosina' href="javascript:;"></a>
					<a class='ybiconfont ybicon-wechatsolid' href="javascript:;"></a>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript" src='assets/js/jquery.min.js'></script>
	<script type="text/javascript" src="assets/js/jquery.fancybox.pack.js"></script>
	<script type="text/javascript" src="assets/js/chosen.jquery.min.js"></script>
	<script type="text/javascript" src='assets/js/turn.js'></script>
	<!-- build:js js/all.js -->
	<script type="text/javascript" src="js/base.js"></script>
	<script type="text/javascript" src="js/check_os.js"></script>
	<!-- endbuild -->
	<script>
	/**
	 * 页面初始化
	 */
	$(document).ready(function() {
		//init();
		//scrollFixed();
		//leftFilter();
		//filterStyle();
		imgAlignCenter();
		bookPreview();
		$('.tpl_sort').chosen({
			disable_search_threshold: 5,
			width: '110px'
		});
		bookPreview({
			container: '.sem_bookpreview_wrapper',
			bookwrapper: '.flipbook_wrapper',
			book: '.flipbook_wrapper .flipbook',
			trigger: '.agbcover_wrapper ul li .preview_book'
		})
	});

	/**
	 * 点击预览效果
	 */
	function bookPreview(options) {
		options=$.extend({
			container: '',
			bookwrapper: '',
			book: '',
			trigger: ''
		}, options);

		var flipbooks = [
				'flipbookpages/1',
				'flipbookpages/2'
			],
			bookIdx = 1,
			//animateFlag = true,
			windowWidth = $(window).width(),
			windowHeight = $(window).height(),
			bookpreviewWrapperEl = $('.sem_bookpreview_wrapper'),
			flipbookWrapperEl = $('.flipbook_wrapper'),
			flipbookEl = $('.flipbook_wrapper .flipbook'),
			//big尺寸书册的0.6倍大小的高度
			flipbookHeight = flipbookEl.height() * 0.6,
			coverlistEl = $('.sem_mainlistul_wrapper li'),
			flipbookWrapperWidth = flipbookWrapperEl.width(),
			thumbnailScale = 0.415,
			destinatePositionX,
			destinatePositionY,
			thumbnailPosition,
			preventDefault;

		//判断滚轮事件是否是火狐的
		var ua = navigator.userAgent.toLowerCase(),
			mousewheel = (ua.indexOf("firefox") > 0) ? 'DOMMouseScroll' : 'mousewheel';
		$(options.trigger).click(function() {
			var $this = $(this),
				thumbnailOffsetLeft = $this.offset().left,
				thumbnailOffsetTop = $this.offset().top,
				thumbnailMarginLeft = 20;
			//图标所在位置，即起始位置
			thumbnailPosition = Number((thumbnailOffsetLeft + thumbnailMarginLeft - flipbookEl.width() * thumbnailScale));
			//目标位置XY
			destinatePositionX = (windowWidth - flipbookWrapperWidth) / 2;
			destinatePositionY = windowHeight - flipbookHeight - 120 > 0 ? (windowHeight - flipbookHeight) / 2 - 50 : 50;
			$('html, body').animate({
				scrollTop: 732
			}, function() {
				expandBook();
			});
			//当打开后组织滚轮默认事件
			preventDefault = $(window).bind(mousewheel, function(e) {
				if (e.preventDefault()) {
					e.preventDefault();
				} else {
					e.returnValue = false;
				}
			});

			function expandBook() {
				bookpreviewWrapperEl.css({
					visibility: 'visible',
					'background-color': 'rgba(0,0,0,0.8)',
					transition: 'background-color 1s'
				});
				$this.find('img').css({
					bottom: 15
				});
				flipbookWrapperEl.transform('translate(' + thumbnailPosition + 'px, -40px) scale(' + thumbnailScale + ',' + thumbnailScale + ')').css({
					visibility: 'visible',
					opacity: 1
				});
				bookpreviewWrapperEl.css({
					transition: 'all 1s',
				});
				//翻到第一页
				flipbookEl.turn('page', 2);
				//展开书册
				setTimeout(function() {
					flipbookWrapperEl.transform('translate(' + destinatePositionX + 'px, ' + (destinatePositionY) + 'px) scale(1,1)').css({
						transition: 'all 1s'
					});
				}, 100);
				//显示左右翻页箭头
				setTimeout(function() {
					flipbookWrapperEl.children('a').css({
						transition: 'all 1s',
						opacity: 1
					});
				}, 1000);
			};
		});
		bookpreviewWrapperEl.find('.closebtn').click(function() {
			//将书册缩小并归回原来位置
			flipbookWrapperEl.transform('translate(' + thumbnailPosition + 'px, -25px) scale(' + thumbnailScale + ',' + thumbnailScale + ')');
			//隐藏箭头
			flipbookWrapperEl.find('a').css({
				opacity: 0
			});
			//隐藏书册背景
			bookpreviewWrapperEl.css({
				'background-color': 'rgba(0,0,0,0)'
			});
			flipbookEl.turn('page', 1);
			//书册收回后进行收尾工作
			setTimeout(function() {
				flipbookWrapperEl.css({
					visibility: 'hidden',
					transition: 'none'
				});
				bookpreviewWrapperEl.css({
					visibility: 'hidden'
				});
				//解除阻止默认滚轮事件
				preventDefault = $(window).unbind(mousewheel);
			}, 1000);
		});
		
		loadApp();

		function loadApp() {
			//这是指定当前读取的是第几本书册的变量，序号是flipbookpages文件夹里的序号
			var bookIdx = 1;
			var pageWidth = $('.flipbook-viewport .page').width();
			var pageHegiht = $('.flipbook-viewport .page').height();
			var flipbook = $('.flipbook');
			var pageSection = $('.chapter_info ul li');

			// if (flipbook.width() == 0 || flipbook.height() == 0) {
			//     setTimeout(loadApp, 10);
			//     return;
			// }

			flipbook.bind('first', function() {
				$('.page-wrapper[page=1]').find('.p1').addClass('hard');
			})

			//点击章节目录中的章节名称跳转到相应的页面中，章节名称所对应的页面序号在html里用page属性做为标记
			pageSection.click(function() {
				var $this = $(this);
				var pageIndex = $this.attr('page');
				$this.addClass('active').siblings().removeClass('active');
				flipbook.turn('page', pageIndex);
			});

			$(document).keydown(function(e) {
				var previous = 37,
					next = 39;
				switch (e.keyCode) {
					case previous:
						flipbook.turn('previous');
						break;
					case next:
						flipbook.turn('next');
						break;
				}
			});

			IEcss()

			flipbook.turn({
				width: 814,
				height: 576,
				elevation: 0,
				acceleration: !isChrome(),
				autoCenter: true,
				gradients: true,
				duration: 1000,
				pages: bookLength(),
				when: {
					turning: function(e, page, view) {
						var book = $(this),
							currentPage = book.turn('page'),
							pages = book.turn('pages');

						// $('.page-wrapper .page').addClass('hard')

						if (currentPage > 3 && currentPage < pages - 3) {
							if (page == 1) {
								book.turn('page', 2).turn('stop').turn('page', page);
								e.preventDefault();
								return;
							} else if (page == pages) {
								book.turn('page', pages - 1).turn('stop').turn('page', page);
								e.preventDefault();
								return;
							}
						} else if (page > 3 && page < pages - 3) {
							if (currentPage == 1) {
								book.turn('page', 2).turn('stop').turn('page', page);
								e.preventDefault();
								return;
							} else if (currentPage == pages) {
								book.turn('page', pages - 1).turn('stop').turn('page', page);
								e.preventDefault();
								return;
							}
						}

						if (page >= 2) {
							$('.flipbook_wrapper .p2').addClass('fixed');
						} else {
							$('.flipbook_wrapper .p2').removeClass('fixed');
						}
						if (page < book.turn('pages')) {
							$('.flipbook_wrapper .p' + (bookLength() - 1)).addClass('fixed');
						} else {
							$('.flipbook_wrapper .p' + (bookLength() - 1)).removeClass('fixed');
						}
						updateDepth(book, page);
						disableControls(page);
					},
					turned: function(e, page, view) {
						var book = $(this);
						updateDepth(book);
						disableControls(page);
						book.turn('center');
					},
					start: function(e, pageObj) {},
					end: function(e, pageObj) {
						var book = $(this);
						updateDepth(book);
						IEcss();
					},
					missing: function(e, pages) {
						for (var i = 0; i < pages.length; i++) {
							addPage(bookIdx, pages[i], $(this));
						}
					}
				}
			});

			flipbook.addClass('animated');

			if (!$.os.mobile) {
				$('.flipbook_nextpage_btn').bind($.mouseEvents.down, function() {
					$(this).addClass('next-button-down');
				}).bind($.mouseEvents.up, function() {
					$(this).removeClass('next-button-down');
				}).click(function() {
					flipbook.turn('next');
				});
				$('.flipbook_prevpage_btn').bind($.mouseEvents.down, function() {
					$(this).addClass('previous-button-down');
				}).bind($.mouseEvents.up, function() {
					$(this).removeClass('previous-button-down');
				}).click(function() {
					flipbook.turn('previous');
				});
			} else {
				$('.flipbook_nextpage_btn').on('touchend', function() {
					flipbook.turn('next');
				});
				$('.flipbook_prevpage_btn').on('touchend', function() {
					flipbook.turn('previous');
				});
			}

			function bookLength() {
				var length = flipbookWrapperEl.attr('pagecount');
				if (length % 2 != 0) {
					return parseInt(length) + 1;
				} else {
					return length;
				}
				return length;
			}

			function getViewNumber(book, page) {
				return parseInt((page || book.turn('page')) / 2 + 1, 10);
			}

			function getViewNumber(book, page) {
				return parseInt((page || book.turn('page')) / 2 + 1, 10);
			}

			function isChrome() {
				return navigator.userAgent.indexOf('Chrome') != -1;
			}

			function loadPage(bookIdx, page) {
				$.ajax({
					url: 'flipbookpages/' + bookIdx + '/page' + page + '.html'
				}).done(function(pageHtml) {
					$('.flipbook .p' + page).html(pageHtml.replace('yb3.0/flipbookpages/', ''));
				});
			}

			function addPage(bookIdx, page, book) {
				var pages = book.turn('pages');
				if (!book.turn('hasPage', page)) {
					var element = $('<div />', {
						'class': 'own-size',
						css: {
							width: 395,
							height: 560,
						}
					}).html('<div class="loader"></div>');
					if (book.turn('addPage', element, page)) {
						loadPage(bookIdx, page);
					}
				}
			}

			function updateDepth(book, newPage) {
				var page = book.turn('page'),
					pages = bookLength(),
					depthWidth = 20 * Math.min(1, (pages - (pages - page)) / pages);
				newPage = newPage || page;

				if (newPage > 3) {
					$('.flipbook-viewport .p2 .depth').css({
						width: depthWidth,
						left: 12 - depthWidth,
						'z-index': 1
					});
				} else {
					$('.flipbook-viewport .p2 .depth').css({
						width: 0,
						'z-index': 1
					});
				}
				depthWidth = 30 * Math.min(1, (pages - page) / pages);
				if (newPage < pages - 3) {
					$('.flipbook-viewport .p' + (pages - 1) + ' .depth').css({
						width: depthWidth,
						right: 12 - depthWidth,
						'z-index': 1
					});
				} else {
					$('.flipbook-viewport .p' + (pages - 1) + ' .depth').css({
						width: 0,
						'z-index': 1
					});
				}
			}

			function disableControls(page) {
				$('.flipbook_nextpage_btn').css({
					'background-color': 'rgba(150,150,150,0.4)',
					'background-position': '-40px 280px'
				});
				$('.flipbook_prevpage_btn').css({
					'background-color': 'rgba(150,150,150,0.4)',
					'background-position': '0 280px'
				})
				if (page == 1) {
					$('.flipbook_prevpage_btn').hide();
					$('.flipbook_nextpage_btn').show().css({
						right: 160,
					});
				} else if (page == $('.flipbook').turn('pages')) {
					var length = $('.flipbook .page-wrapper').length;
					$('.flipbook_prevpage_btn').show().css({
						left: 180
					});
					$('.flipbook_nextpage_btn').hide();
				} else {
					$('.flipbook_prevpage_btn').show().css({
						left: '-25px'
					});
					$('.flipbook_nextpage_btn').show().css({
						right: '-40px'
					});
				}
			}

			function IEcss(argu) {
				if (window.ActiveXObject || 'ActiveXObject' in window) {
					$('.flipbook-viewport .secondcover>div').css({
						left: 13
					});
				}
			}
		}

		// $(".agbcover_wrapper ul").on('click', '.bookcover', function() {
		// 	$.fancybox.open({
		// 		href: 'bp_popupwindow.html',
		// 		type: 'iframe',
		// 		width: 950,
		// 		height: 740,
		// 		padding: 5,
		// 		scrolling: 'no'
		// 	});
		// });

		// $(".agbcover_wrapper ul").on('click', '.preview_book', function() {
		// 	$.fancybox.open({
		// 		href: 'bp_popupwindow.html',
		// 		type: 'iframe',
		// 		width: 950,
		// 		height: 740,
		// 		padding: 5,
		// 		scrolling: 'no'
		// 	});
		// });
	}
	/*左侧风格选中效果*/
	$('.filter_style .filter_item ul li a').click(function() {
			$('.filter_style .filter_item ul li a').each(function() {
				$(this).removeClass('active');
			});
			$(this).addClass('active');
		})
		/**
		 * 获取一个书册的HTML，此处后台需要修改
		 * @returns {string}
		 */
	function getOneBookHtml() {
		return ' <li> ' +
			'<a class="bookcover" href="javascript:;">' +
			'<span class="agbcover_bg_item"></span>' +
			'<img src="img/default/albumcover_205_295_1_00000.jpg">' +
			' </a>' +
			'<b class="agbcover_title">青春记忆</b>' +
			'<div class="agbcover_price"></div>' +
			'<a class="beginproduce" href="booklist_detail.html">我要制作</a>' +
			' </li>';
	}

	function init() {
		$('.agb_bannermenu_wrapper li').click(function() {
			var $this = $(this);
			var index = 0;
			$this.addClass('active').siblings('li').removeClass('active');
			index = $this.index();
			$('.agb_bannermain_wrapper li').eq(index).addClass('active').siblings('li').removeClass('active');
		})

		//加载更多，模拟，后台需要修改从ajax获取数据
		$('.all_loadmore a').click(function() {
			for (var i = 0; i < 10; i++) {
				var html = getOneBookHtml();
				$('.agbcover_wrapper ul').append(html);
				filterStyle();
			}
		});
	}

	function imgAlignCenter() {
		$('.agb_bannermain_wrapper img').css('left', -(1920 - $(window).width()) / 2);
		$(window).resize(function() {
			$('.agb_bannermain_wrapper img').css('left', -(1920 - $(window).width()) / 2);
		})
	}

	/**
	 * 左侧选择栏固定效果
	 */
	function scrollFixed() {
		var filterWrapper = $('.left_content_wrapper');
		var filterHeight = $(window).height() - 130;
		window.onscroll = function() {
			var scrollTop = $(window).scrollTop();
			if (scrollTop > 400) {
				filterWrapper.css({
					'position': 'fixed',
					'top': '0',
					'height': filterHeight,
					'overflow': 'auto'
				});
			} else {
				filterWrapper.css({
					'position': 'relative'
				});
			}
		}
	}

	function leftFilter() {
		//选择取消全部类型
		chooseOrCancelDiv('.all_type', function() {
			$('.all_type, .one_type:not([active])').addClass('active');
			alert("选择全部类型");
		}, function() {
			$('.all_type, .one_type').removeClass('active');
			alert("取消全部类型");
		});

		//单个类型
		chooseOrCancelDiv('.one_type', function($div) {
			$('.all_type').removeClass('active');
			$div.addClass('active');
			alert("选择单个类型");
		}, function($div) {
			$('.all_type').removeClass('active');
			$div.removeClass('active');
			alert("取消单个类型");
		});

		//选择取消去不风格
		chooseOrCancelDiv('.all_style', function() {
			$('.all_style, .one_style:not([active])').addClass('active');
			alert("选择全部风格");
		}, function() {
			$('.all_style, .one_style').removeClass('active');
			alert("取消全部风格");
		});

		//单个风格
		chooseOrCancelDiv('.one_style', function($div) {
			$('.all_style').removeClass('active');
			$div.addClass('active');
			alert("选择单个风格");
		}, function($div) {
			$('.all_style').removeClass('active');
			$div.removeClass('active');
			alert("取消单个风格");
		});
		/**
		 * 左侧过滤选择效果
		 */
		function chooseOrCancelDiv(div, choose, cancel) {
			$(div).click(function() {
				var _this = $(this);
				if (_this.hasClass('active')) {
					if (cancel)
						cancel(_this);
					//取消全部
				} else {
					if (choose)
						choose(_this);
					//选择全部
				}
			});
		}
	}

	//控制筛选器的高度
	function filterStyle() {
		var filteritemEl = $('.filter_item');
		judgeMaxheight();
		$(window).resize(function() {
			judgeMaxheight();
		});

		function judgeMaxheight() {
			var availHeight = $(window).height();
			//150指的是footer的高度130加左右两侧margintop的20
			var maxheight = (availHeight - 150) / 2;
			$('.left_content_wrapper').css('max-height', availHeight - 150)
			if ($('.right_content_wrapper').height() < availHeight - 150) {
				filteritemEl.css({
					'max-height': maxheight,
					'overflow': 'auto'
				});
			} else {
				filteritemEl.css({
					'max-height': 'none',
					'overflow': 'none'
				});
			}

		}
	}
	</script>
</body>