<!DOCTYPE html>
<html>

<head lang="ch">
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" id="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <title>互动册模板</title>
    <!-- build:css ../css/m.all.min.css -->
    <link rel="stylesheet" href="../css/m_reset.css" type="text/css"/>
    <link rel="stylesheet" href="../css/m_common.css" type="text/css"/>
    <link rel="stylesheet" href="../css/m_booklist.css" type="text/css"/>
    <!-- endbuild -->
    <link rel="stylesheet" href="../assets/css/normalize.css" type="text/css" media="all">
    <link rel="stylesheet" href="../assets/css/bootstrap.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="../assets/css/bootstrap-theme.min.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="../assets/css/swiper.min.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="../assets/css/font-awesome.css" type="text/css" media="all"/>

    <link rel="stylesheet" href="http://at.alicdn.com/t/font_1457004547_639932.css " type="text/css" media="all"/>
</head>

<body class='bg_f6f6f6'>
<div class="main_container booklist_wrapper has_footer_nav">
    <div class="ybwechatheader_wrapper">
        <a class='left_btn list_btn' href='javascript:;'>
            <span class="iconfont icon-037fenlei"></span>
        </a>
        <p>互动册模板</p>
    </div>
    <div class="ia_classify swiper-pagination"></div>
    <div class='mybookshelf_main_wrapper swiper-container'>
        <div class="swiper-wrapper ">
            <div class="swiper-slide">
                <ul>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《推荐》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                </ul>
                <div class='ybwechat_loading_item'>
                    <a href="javascript:;">点击加载更多（<b>6</b>）</a>
                </div>
            </div>
            <div class="swiper-slide">
                <ul>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《热门》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                </ul>
                <div class='ybwechat_loading_item'>
                    <a href="javascript:;">点击加载更多（<b>6</b>）</a>
                </div>
            </div>
            <div class="swiper-slide">
                <ul>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《毕业册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                </ul>
                <div class='ybwechat_loading_item'>
                    <a href="javascript:;">点击加载更多（<b>6</b>）</a>
                </div>
            </div>
            <div class="swiper-slide">
                <ul>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《聚会册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                    <li>
                        <a class='cover' href="javascript:;">
                            <span></span>
                            <img src="../img/m/default/bookdetail_cover_00000.jpg">
                        </a>
                        <label>《宝宝相册》</label>
                        <p>入册照片:<span>40</span>张</p>
                        <a class='ybwechat_list_btn' href="javascript:;">模板预览</a>
                    </li>
                </ul>
                <!--<div class='ybwechat_loading_item'>
                    <a href="javascript:;">点击加载更多（<b>6</b>）</a>
                </div>-->
            </div>
        </div>
        <div class='empty_item hidden'>
            <img src="../img/m/bierde_16.png">
            <p>对不起，没有符合要求的书册！</p>
        </div>
    </div>
</div>
<div class="ft_pc">
    <i class="icon-desktop"></i><a href="#">切换至电脑版</a>
</div>
<div class="tpl_classify_con">
    <div class="classify">
        <a class="close icon-remove" href="javascript:;"></a>
        <div class="">
            <h4>照片书</h4>
            <ul>
                <li>
                    <a href="booklist_photo3.9.html?data-style=2">
                        宝宝
                    </a>
                </li>
                <li>
                    <a href="booklist_photo3.9.html?data-style=3">
                        旅行
                    </a>
                </li>
                <li>
                    <a href="booklist_photo3.9.html?data-style=4">
                        爱情
                    </a>
                </li>
                <li>
                    <a href="booklist_photo3.9.html?data-style=5">
                        聚会
                    </a>
                </li>
                <li>
                    <a href="booklist_photo3.9.html?data-style=6">
                        父母
                    </a>
                </li>
                <li>
                    <a href="booklist_photo3.9.html?data-style=6">
                        家庭
                    </a>
                </li>
                <li>
                    <a href="booklist_photo3.9.html?data-style=7">
                        写真
                    </a>
                </li>
                <li>
                    <a href="booklist_photo3.9.html?data-style=0">
                        作品
                    </a>
                </li>
                <li>
                    <a href="booklist_photo3.9.html?data-style=1">
                        圈子
                    </a>
                </li>
            </ul>
            <h4>互动册</h4>
            <ul>
                <li>
                    <a href="javascript:;" data-style="2">
                        宝宝
                    </a>
                </li>
                <li>
                    <a href="javascript:;" data-style="3">
                        旅行
                    </a>
                </li>
                <li>
                    <a href="javascript:;" data-style="1">
                        爱情
                    </a>
                </li>
                <li>
                    <a href="javascript:;" data-style="3">
                        聚会
                    </a>
                </li>
                <li>
                    <a href="javascript:;" data-style="1">
                        父母
                    </a>
                </li>
                <li>
                    <a href="javascript:;" data-style="3">
                        家庭
                    </a>
                </li>
                <li>
                    <a href="javascript:;" data-style="0">
                        写真
                    </a>
                </li>
                <li>
                    <a href="javascript:;" data-style="0">
                        作品
                    </a>
                </li>
                <li>
                    <a href="javascript:;" data-style="1">
                        圈子
                    </a>
                </li>
            </ul>
        </div>
    </div>
</div>
<!--底部导航-->
<div class="footer_nav">
    <ul>
        <li>
            <a href="index.html">
                <span class="home"></span>
                <p>首页</p>
            </a>
        </li>
        <li>
            <a href="ia_msg.html">
                <span class="msg"></span>
                <p>消息</p>
            </a>
        </li>
        <li class="active" id="open_new_option">
            <a href="javascript:;">
                <span class="new"></span>
                <p>新建</p>
            </a>
        </li>
        <li>
            <a href="pc_mybookshelf.html">
                <span class="bookshelf"></span>
                <p>书架</p>
            </a>
        </li>
        <li>
            <a href="pc_main.html">
                <span class="my"></span>
                <p>我的</p>
            </a>
        </li>
    </ul>
</div>
<!--pop new content-->
<div class="open_new_container">
    <div class="new_option">
        <ul>
            <li class="new_ph">
                <a href="booklist_photo.html">
                    <img src="../img/m/icon/new_photo_book.png">
                    <p>新建照片书</p>
                </a>
            </li>
            <li class="new_ia">
                <a href="booklist_ia.html">
                    <img src="../img/m/icon/new_interact_book.png">
                    <p>新建互动册</p>
                </a>
            </li>
            <li class="join_ia">
                <a href="ia_invitation_joinbook.html">
                    <img src="../img/m/icon/join_interact_book.png">
                    <p>加入互动册</p>
                </a>
            </li>
        </ul>
    </div>
    <div class="close_btn"><a href="javascript:;">×</a></div>
</div>
</body>
<script type="text/javascript" src="../assets/js/jquery.min.js"></script>
<script type="text/javascript" src="../assets/js/swiper.jquery.min.js"></script>
<script type="text/javascript" src="../js/m_main.js"></script>
<script type="text/javascript">
    $(function () {
        choosetemplate();
        showTplClassify();
        initPhotoBookListSwiper();
    });

    function choosetemplate() {
        var ctBtn = $('.choosetype_wrapper a');
        ctBtn.on('touchend', function () {
            var $this = $(this);
            $this.parent().siblings().find('.choosetemplate_btn').text('选择模板');
            $this.parent().siblings().removeClass('active').end().addClass('active').find('.choosetemplate_btn').text('已选择');
        })
    }

    function showTplClassify(){
        $('.ybwechatheader_wrapper .list_btn').on('click',function(){
            $('.tpl_classify_con').show();
        });
        $('.tpl_classify_con .close').on('click',function(e){
            $('.tpl_classify_con').hide();
            e.stopPropagation();
        });

    }

    function initPhotoBookListSwiper(){
        var mySwiper = new Swiper('.mybookshelf_main_wrapper.swiper-container', {
            loop: true,
            pagination: '.swiper-pagination',
            paginationClickable: true,
            autoHeight: true,
            autoplay: false,
            paginationBulletRender: function (index, className) {
                switch (index) {
                    case 0: name='推荐';break;
                    case 1: name='热门';break;
                    case 2: name='毕业册';break;
                    case 3: name='聚会册';break;
                    default: name='';
                }
                return '<span class="' + className + '">' + name + '</span>';
            },
            onInit: function(swiper){
                $('.swiper-slide').each(function(){
                    if($(this).find('li').length > 9){
                        $(this).find('li:gt(8)').hide();
                        $(this).find('.ybwechat_loading_item').css('display','block');
                        var swiperHeight = $(this).find('ul').height() + 70;

                        $(this).closest('.swiper-wrapper').height(swiperHeight);

                    }
                    var minHeight = $(window).height() - 230;
                    $(this).css('min-height',minHeight);
                    loadMoreTpl();
                })
            },
            onSlideChangeEnd: function(swiper){
//                loadMoreTpl();
               /* var index = mySwiper.activeIndex- 1,
                        width = $('.swiper-pagination-bullet').width(),
                        left = (index)*(width);
                $('.swiper-pagination').scrollLeft(left);*/
            }
        });

        //页面内选择模板类别
        $('.classify li a').on('click',function(e){
            var activeIndex = $(this).attr('data-style');
            $('.tpl_classify_con').hide();
            mySwiper.slideTo(activeIndex, 1000, true);
            /*var scrollLeft = $('.swiper-pagination-bullet').width()*(activeIndex-1);
            $('.swiper-pagination').scrollLeft(scrollLeft);*/
            $('.swiper-pagination span').removeClass('swiper-pagination-bullet-active').eq(activeIndex).addClass('swiper-pagination-bullet-active');
            e.stopPropagation();
        });

        //跨页面选择模板类别
        var href = window.location.href;
        var reg = /(data-style=[0-9])$/g;
        var dataStyle = href.match(reg);
        if(dataStyle){
            var chooseStyleIndex = dataStyle[0].split('=')[1];
            mySwiper.slideTo(chooseStyleIndex, 1000, true);
            $('.swiper-pagination span').removeClass('swiper-pagination-bullet-active').eq(chooseStyleIndex).addClass('swiper-pagination-bullet-active');
        };
    }

    function loadMoreTpl() {
        var limitNum = 8;
        //所有显示
        var all = $('.swiper-slide-active li').length;
        //当前显示的个数
        var visi = $('.swiper-slide-active li:visible').length;

        if (all > 9) {
            $('.swiper-slide-active .ybwechat_loading_item').css('display','block');
        }

        $('.swiper-slide-active .ybwechat_loading_item b').text(all - visi);

        if (all == visi) {
            $('.swiper-slide-active .ybwechat_loading_item').css('display','none');
        }

        $('.swiper-slide-active .ybwechat_loading_item a').on('touchend', function () {
            limitNum += 6;
            $(this).closest('.swiper-slide').find('li').each(function (index) {
                if (index >= (limitNum - 6) && index <= limitNum) {
                    $(this).show()
                    var height = $(this).closest('.swiper-slide ul').height() + 70;
                    $('.swiper-wrapper').css('height', height);
                }
            })

            visi = $('.swiper-slide-active li:visible').length;
            $('.swiper-slide-active .ybwechat_loading_item b').text(all - visi);
            if (all == visi) {
                $('.swiper-slide-active .ybwechat_loading_item').css('display','none');
            }
        });

    }
</script>

</html>
