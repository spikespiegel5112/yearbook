<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" id="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <title>编辑相册-移动照片</title>
    <!-- build:css ../css/m.all.min.css -->
    <link rel="stylesheet" type="text/css" href="../css/m_reset.css">
    <link rel="stylesheet" type="text/css" href="../css/m_common.css">
    <link rel="stylesheet" type="text/css" href="../css/m_ia.css">
    <!-- endbuild -->
    <link rel="stylesheet" href="../assets/css/normalize.css" type="text/css" media="all">
    <link rel="stylesheet" href="../assets/css/bootstrap.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="../assets/css/bootstrap-theme.min.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="../assets/css/font-awesome.css" type="text/css" media="all"/>
    <link rel="stylesheet" href="http://at.alicdn.com/t/font_1457084893_226195.css" type="text/css" media="all"/>
</head>
<body>
<div class="mian_container album_list_container bg_f5f5f5">
    <div class='ybwechatheader_wrapper positionfixed'>
        <a class='left_btn back_btn' href='javascript:;'>
            <span class="ybiconfont ybicon-backward1"></span>
        </a>
        <p>移动到</p>
        <a class='right_btn add_btn' href='javascript:;'><span class="ybiconfont ybicon-plus"></span></a>
    </div>
    <div class="album_list_wrapper">
        <div class='album_list_inner'>
            <ul>
                <li>
                    <a class="album_list_corver" href="ia_album_photolist.html"><img
                            src="../img/m/default/yb_wechat_album_list_1_00000.jpg"></a>

                    <div class="album_list_desc_item">
                        <h5>相册1</h5>

                        <p>共<span>28</span>张</p>
                    </div>
                    <a class="album_list_arrow ybiconfont ybicon-forward3" href="ia_album_photolist.html"></a>
                </li>
                <li>
                    <a class="album_list_corver" href="ia_album_photolist.html"><img
                            src="../img/m/default/yb_wechat_album_list_1_00000.jpg"></a>

                    <div class="album_list_desc_item">
                        <h5>相册1</h5>

                        <p>共<span>28</span>张</p>
                    </div>
                    <a class="album_list_arrow ybiconfont ybicon-forward3" href="ia_album_photolist.html"></a>
                </li>
                <li>
                    <a class="album_list_corver" href="ia_album_photolist.html"><img
                            src="../img/m/default/yb_wechat_album_list_1_00000.jpg"></a>

                    <div class="album_list_desc_item">
                        <h5>相册1</h5>

                        <p>共<span>28</span>张</p>
                    </div>
                    <a class="album_list_arrow ybiconfont ybicon-forward3" href="ia_album_photolist.html"></a>
                </li>
                <li>
                    <a class="album_list_corver" href="ia_album_photolist.html"><img
                            src="../img/m/default/yb_wechat_album_list_1_00000.jpg"></a>

                    <div class="album_list_desc_item">
                        <h5>相册1</h5>

                        <p>共<span>28</span>张</p>
                    </div>
                    <a class="album_list_arrow ybiconfont ybicon-forward3" href="ia_album_photolist.html"></a>
                </li>
            </ul>
        </div>
    </div>
    <div class="album_content_empty_item">
        <img src="../img/m/default/album_empty_bg_2_00000.jpg" width="360" height="360">
        <input class="album_content_upload_button_2" type="button" value="创建相册">
    </div>
    <div class="loading" style="display: none;">
        <img src="../img/m/loading.gif"><strong>加载中</strong>
    </div>
</div>
<script type="text/javascript" src="../assets/js/jquery.min.js"></script>
<script type="text/javascript" src='../assets/js/iscroll.js'></script>
<script type="text/javascript">
    var availWidth = $(document).width();
    var availHeight = $(document).height();
    // alert(availWidth)
    $(".album_list_container").css({"height": availHeight - 30});

    // 显示loading
    var showloading = function (txt) {
        if (typeof(txt) === 'string')
            $('.loading strong').text(txt);
        if (typeof(loading) === 'undefined')
            loading = $('.loading');
        loading.show();
    };
    //隐藏loading
    var hideloading = function () {
        if (typeof(loading) === 'undefined')
            loading = $('.loading');
        setTimeout(function () {
            loading.hide();
            $('.loading strong').text('加载中');
        }, 1000);
    };
    var getHtml = function (argu) {
        return '<li><a class="album_list_corver" href="ia_album_photolist.html"><img src="../img/m/default/yb_wechat_album_list_1_00000.jpg"></a><div class="album_list_desc_item"><h5>相册' + argu + '</h5><p>共<span>28</span>张</p></div><a class="album_list_arrow ybiconfont ybicon-forward3" href="ia_album_photolist.html"></a></li>'
    }


    var createIScroll = function (selector, pullDownFunc, pullUpFunc, opts, pullText) {
        //自定义提示文字
        var pulldownText = pullText && pullText['pulldownText'] ? pullText['pulldownText'] : '下拉可以刷新',
                pullupText = pullText && pullText['pullupText'] ? pullText['pullupText'] : '上拉加载更多',
                releasedownText = pullText && pullText['releasedownText'] ? pullText['releasedownText'] : '松手可以刷新',
                releaseupText = pullText && pullText['releaseupText'] ? pullText['releaseupText'] : '松手加载更多',
                loadingText = pullText && pullText['loadingText'] ? pullText['loadingText'] : '加载中';
        //生成iscroll
        var options = {
            //bounceLock : true,
            //bounceEasing : 'circular'
            scrollbars: true,
            fadeScrollbars: true,
            bounceLock: true,
            momentum: false
        };
        $.extend(true, options, opts);
        var newScroller = new IScroll(selector, options);

        //定义下拉和上拉的方法
        if (typeof(pullDownFunc) === 'function' || typeof(pullUpFunc) === 'function') {
            if (typeof(pullDownFunc) === 'function') {
                //tr('有下拉函数');
                var $container = $(selector + '>:first-child');
                $container.append('<div class="scroll_pulldown_icon"></div><div class="scroll_pulldown">' + pulldownText + '</div>');
            }
            if (typeof(pullUpFunc) === 'function') {
                //tr('有上拉函数');
                var $container = $(selector + '>:first-child');
                $container.prepend('<div class="scroll_pullup_icon"></div><div class="scroll_pullup">' + pullupText + '</div>');
            }
            //监听滑动，改变图示和文字
            newScroller.on('scrollMove', function () {
                if (this.y > 50) {
                    $('.scroll_pulldown_icon').addClass('scroll_pulldown_flip');
                    $('.scroll_pulldown').text(releasedownText);
                }
                else {
                    $('.scroll_pulldown_icon').removeClass('scroll_pulldown_flip');
                    $('.scroll_pulldown').text(pulldownText);
                }
                if (this.y < -$container.height() + $(selector).height()) {
                    $('.scroll_pullup_icon').addClass('scroll_pullup_flip');
                    $('.scroll_pullup').text(releaseupText);
                }
                else {
                    $('.scroll_pullup_icon').removeClass('scroll_pullup_flip');
                    $('.scroll_pullup').text(pullupText);
                }
                //tr(this.y);
            });
            newScroller.on('scrollEnd', function () {
                if ($('.scroll_pulldown_icon').hasClass('scroll_pulldown_flip')) {
                    $('.scroll_pulldown_icon').removeClass('scroll_pulldown_flip');
                    pullDownFunc.call();
                }
                if ($('.scroll_pullup_icon').hasClass('scroll_pullup_flip')) {
                    $('.scroll_pullup_icon').removeClass('scroll_pullup_flip');
                    pullUpFunc.call();
                }
            });
        }
        return newScroller;
    }
    setTimeout(function () {
        var mScroller = createIScroll('.album_list_wrapper', function () {
            showloading();
            //修改成从后台读取
            var i = 0;
            var count = Math.floor(Math.random() * 5)
            for (i = 0; i < count; i++) {
                $('.album_list_wrapper ul').prepend(getHtml(i));
            }
            touchFlag = true;
            mScroller.refresh();
            hideloading();
        }, null, {
            mouseWheel: true,
            scrollbars: false,
            bounceLock: false
        });
    }, 500);
</script>
</body>
</html>